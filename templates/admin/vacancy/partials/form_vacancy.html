{% load static %}
{% load crispy_forms_tags %}

<!-- Sistema de badges de error simplificado -->
<script>
// Función simple para detectar errores
function hasErrorsInSection(sectionFields) {
    {% if form.errors %}
        const formErrors = {
            {% for field, errors in form.errors.items %}
                "{{ field }}": true{% if not forloop.last %},{% endif %}
            {% endfor %}
        };
        
        // Verificar si algún campo de la sección tiene errores
        for (let field of sectionFields) {
            if (formErrors[field]) {
                return true;
            }
        }
        return false;
    {% endif %}
    return false;
}

// Definir campos por sección basado en las validaciones del formulario
const sectionFields = {
    1: [
        // Información básica
        'cargo', 'termino_contrato', 'modalidad', 'numero_posiciones', 'cantidad_presentar', 'fecha_presentacion',
        // Ubicación
        'lugar_trabajo', 'barrio', 'direccion',
        // Salario
        'salario', 'tipo_salario', 'frecuencia_pago', 'salario_adicional',
        // Edad y género
        'edad_inicial', 'edad_final', 'genero',
        // Motivo vacante
        'motivo_vacante', 'otro_motivo',
        // Horarios
        'tipo_horario', 'horario_inicio_1', 'horario_final_1', 'hora_inicio_1', 'hora_final_1',
        'horario_inicio_2', 'horario_final_2', 'hora_inicio_2', 'hora_final_2',
        'horario_inicio_3', 'horario_final_3', 'hora_inicio_3', 'hora_final_3',
        // Funciones y responsabilidades
        'funciones_responsabilidades_1', 'funciones_responsabilidades_2', 'funciones_responsabilidades_3'
    ],
    2: [
        // Experiencia laboral
        'tiempo_experiencia_1', 'experiencia_especifica_en_1', 'tiempo_experiencia_2', 'experiencia_especifica_en_2', 
        'tiempo_experiencia_3', 'experiencia_especifica_en_3',
        // Idiomas
        'idioma_1', 'nivel_idioma_1', 'idioma_2', 'nivel_idioma_2',
        // Estudios
        'tipo_profesion', 'profesion_estudio', 'grupo_profesion', 'profesion_estudio_listado', 'nivel_estudio', 'estado_estudio',
        // Estudios complementarios
        'estudios_complementarios_1', 'estudios_complementarios_certificado_1',
        'estudios_complementarios_2', 'estudios_complementarios_certificado_2',
        'estudios_complementarios_3', 'estudios_complementarios_certificado_3'
    ],
    3: [
        // Habilidades (skills)
        'skill_relacionales', 'skill_personales', 'skill_cognitivas', 'skill_digitales', 'skill_liderazgo'
    ],
    4: [
        // Fit cultural
        'grupo_fit_1', 'grupo_fit_2', 'grupo_fit_3', 'grupo_fit_4', 'grupo_fit_5'
    ],
    5: [
        // Motivadores
        'motivadores_candidato', 'otro_motivador'
    ],
    6: [
        // Comentarios finales
        'comentarios', 'descripcion_vacante'
    ]
};

// Función simple para mostrar badges y navegar
function updateErrorBadges() {
    let firstErrorSection = null;
    
    // Mostrar/ocultar badges
    for (let section = 1; section <= 6; section++) {
        const badge = document.getElementById(`error-badge-${section}`);
        const hasErrors = hasErrorsInSection(sectionFields[section]);
        
        if (badge) {
            badge.style.display = hasErrors ? 'block' : 'none';
            
            if (hasErrors && firstErrorSection === null) {
                firstErrorSection = section;
            }
        }
    }
    
    // Navegar a la primera pestaña con error
    if (firstErrorSection !== null) {
        // Usar Bootstrap para cambiar de pestaña
        const tabTrigger = document.querySelector(`[data-bs-target="#pane-data${firstErrorSection}"]`);
        if (tabTrigger) {
            const tab = new bootstrap.Tab(tabTrigger);
            tab.show();
        }
    }
}

// Ejecutar cuando el DOM esté listo
document.addEventListener('DOMContentLoaded', function() {
    // Ejecutar inmediatamente
    updateErrorBadges();
    
    // Ejecutar después de un delay para asegurar que Bootstrap esté cargado
    setTimeout(updateErrorBadges, 1000);
    
    // Función de prueba
    window.testErrorBadges = function() {
        for (let i = 1; i <= 6; i++) {
            const badge = document.getElementById(`error-badge-${i}`);
            if (badge) {
                badge.style.display = 'block';
            }
        }
    };
    
    // Función para ocultar badges
    window.hideErrorBadges = function() {
        for (let i = 1; i <= 6; i++) {
            const badge = document.getElementById(`error-badge-${i}`);
            if (badge) {
                badge.style.display = 'none';
            }
        }
    };
});
</script>

<!-- Script adicional para asegurar que funcione después de Bootstrap -->
<script>
// Ejecutar después de que Bootstrap esté completamente cargado
window.addEventListener('load', function() {
    setTimeout(function() {
        updateErrorBadges();
    }, 500);
});

// También ejecutar cuando se hace clic en el botón de envío
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('form_vacante_todos');
    if (form) {
        form.addEventListener('submit', function(e) {
            // Si hay errores, ejecutar después de que se muestren
            setTimeout(function() {
                updateErrorBadges();
            }, 100);
        });
    }
});

// Debug: función para verificar si hay errores
window.debugErrors = function() {
    console.log('=== DEBUG DE ERRORES ===');
    {% if form.errors %}
        console.log('Hay errores en el formulario:');
        {% for field, errors in form.errors.items %}
            console.log('Campo "{{ field }}": {{ errors|length }} errores');
        {% endfor %}
        
        // Verificar cada sección
        for (let section = 1; section <= 6; section++) {
            const hasErrors = hasErrorsInSection(sectionFields[section]);
            console.log(`Sección ${section} tiene errores: ${hasErrors}`);
            if (hasErrors) {
                console.log('Campos de la sección:', sectionFields[section]);
            }
        }
    {% else %}
        console.log('No hay errores en el formulario');
    {% endif %}
    
    // Verificar si los badges existen
    for (let i = 1; i <= 6; i++) {
        const badge = document.getElementById(`error-badge-${i}`);
        console.log(`Badge ${i} existe: ${badge !== null}`);
        if (badge) {
            console.log(`Badge ${i} visible: ${badge.style.display !== 'none'}`);
        }
    }
};
</script>
<ul class="nav nav-tabs justify-content-between border-0 mb-4 wizard-tabs2" id="myTabstep2" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link p-0 d-flex align-items-center active" id="tab-data1" data-bs-toggle="tab" data-bs-target="#pane-data1" type="button" role="tab" aria-controls="data1-tab-pane" aria-selected="true">
            <span class="fs-20 fw-bold text-primary wh-48 bg-primary bg-opacity-10 rounded-circle d-inline-block position-relative">1
                <span id="error-badge-1" class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle error-badge" style="display: none;">
                    <span class="visually-hidden">New alerts</span>
                </span>
            </span>
            <div class="text-start ms-3">
                <h4 class="fs-18 fw-semibold">Datos Principales</h4>
            </div>
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link p-0 d-flex align-items-center" id="tab-data2" data-bs-toggle="tab" data-bs-target="#pane-data2" type="button" role="tab" aria-controls="data2-tab-pane" aria-selected="false">
            <span class="fs-20 fw-bold text-primary wh-48 bg-primary bg-opacity-10 rounded-circle d-inline-block position-relative">2
                <span id="error-badge-2" class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle error-badge" style="display: none;">
                    <span class="visually-hidden">New alerts</span>
                </span>
            </span>
            <div class="text-start ms-3">
                <h4 class="fs-18 fw-semibold">Requisitos Técnicos</h4>
            </div>
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link p-0 d-flex align-items-center" id="tab-data3" data-bs-toggle="tab" data-bs-target="#pane-data3" type="button" role="tab" aria-controls="data3-tab-pane" aria-selected="false">
            <span class="fs-20 fw-bold text-primary wh-48 bg-primary bg-opacity-10 rounded-circle d-inline-block position-relative">3
                <span id="error-badge-3" class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle error-badge" style="display: none;">
                    <span class="visually-hidden">New alerts</span>
                </span>
            </span>
            <div class="text-start ms-3">
                <h4 class="fs-18 fw-semibold">Competencias</h4>
            </div>
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link p-0 d-flex align-items-center" id="tab-data4" data-bs-toggle="tab" data-bs-target="#pane-data4" type="button" role="tab" aria-controls="data4-tab-pane" aria-selected="false">
            <span class="fs-20 fw-bold text-primary wh-48 bg-primary bg-opacity-10 rounded-circle d-inline-block position-relative">4
                <span id="error-badge-4" class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle error-badge" style="display: none;">
                    <span class="visually-hidden">New alerts</span>
                </span>
            </span>
            <div class="text-start ms-3">
                <h4 class="fs-18 fw-semibold">Fit Cultural</h4>
            </div>
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link p-0 d-flex align-items-center" id="tab-data5" data-bs-toggle="tab" data-bs-target="#pane-data5" type="button" role="tab" aria-controls="data5-tab-pane" aria-selected="false">
            <span class="fs-20 fw-bold text-primary wh-48 bg-primary bg-opacity-10 rounded-circle d-inline-block position-relative">5
                <span id="error-badge-5" class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle error-badge" style="display: none;">
                    <span class="visually-hidden">New alerts</span>
                </span>
            </span>
            <div class="text-start ms-3">
                <h4 class="fs-18 fw-semibold">Motivadores</h4>
            </div>
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link p-0 d-flex align-items-center" id="tab-data6" data-bs-toggle="tab" data-bs-target="#pane-data6" type="button" role="tab" aria-controls="data6-tab-pane" aria-selected="false">
            <span class="fs-20 fw-bold text-primary wh-48 bg-primary bg-opacity-10 rounded-circle d-inline-block position-relative">6
                <span id="error-badge-6" class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle error-badge" style="display: none;">
                    <span class="visually-hidden">New alerts</span>
                </span>
            </span>
            <div class="text-start ms-3">
                <h4 class="fs-18 fw-semibold">Comentarios</h4>
            </div>
        </button>
    </li>
</ul>

<form method="post" enctype="multipart/form-data" id="form_vacante_todos">
    {% csrf_token %}
    <div class="tab-content" id="myTabstep2Content">
        
        <div class="tab-pane fade show active" id="pane-data1" role="tabpanel" aria-labelledby="tab-data1" tabindex="0">
            <h4 class="fs-18 fw-semibold">Información General del cargo</h4>
            <p class="text-gray-light mb-4">Es la información que precisa las caracteristicas principales de la vacante</p>
            <div class="row mb-4 p-3 border rounded bg-primary bg-opacity-10">
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Información Básica</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-8">
                    {{ form.cargo|as_crispy_field }}
                </div>    
                <div class="col-md-4">
                    {{ form.termino_contrato|as_crispy_field }}
                </div>    
                <div class="col-md-3">
                    {{ form.modalidad|as_crispy_field }}
                </div>    
                <div class="col-md-3">
                    {{ form.numero_posiciones|as_crispy_field }}
                </div>    
                <div class="col-md-3">
                    {{ form.cantidad_presentar|as_crispy_field }}
                </div>    
                <div class="col-md-3">
                    {{ form.fecha_presentacion|as_crispy_field }}
                </div>  
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Ubicación</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-4">
                    {{ form.lugar_trabajo|as_crispy_field }}
                </div>    
                <div class="col-md-4">
                    {{ form.barrio|as_crispy_field }}
                </div>    
                <div class="col-md-4">
                    {{ form.direccion|as_crispy_field }}
                </div>    
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Salario</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-3">
                    {{ form.salario|as_crispy_field }}
                </div>    
                <div class="col-md-3">
                    {{ form.tipo_salario|as_crispy_field }}
                </div>    
                <div class="col-md-3">
                    {{ form.frecuencia_pago|as_crispy_field }}
                </div>    
                <div class="col-md-3">
                    {{ form.salario_adicional|as_crispy_field }}
                </div>   
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Edad y Genero</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div> 
                <div class="col-md-2">
                    {{ form.edad_inicial|as_crispy_field }}
                </div>   
                <div class="col-md-2">
                    {{ form.edad_final|as_crispy_field }}
                </div>   
                <div class="col-md-2">
                    {{ form.genero|as_crispy_field }}
                </div>
                <div class="col-md-2">
                    {{ form.motivo_vacante|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.otro_motivo|as_crispy_field }}
                </div>
                
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Horarios</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>

                <div class="row justify-content-end align-center">
                    <div class="col-md-12">
                        {{ form.tipo_horario|as_crispy_field }}
                    </div>
                </div>
                <!-- Bloques de horarios - ocultos por defecto -->
                <div class="row justify-content-end align-center d-none" id="bloque_1">
                    <div class="d-flex align-items-center my-4">
                        <div class="w-100 d-flex align-items-center" style="position: relative;">
                            <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                            <p class="position-absolute start-50 translate-middle-x mb-0 px-3 bg-white text-primary" style="z-index:1;">Bloque 1</p>
                            <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                        </div>
                    </div>
                    <div class="col-md-3">
                        {{ form.horario_inicio_1|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.horario_final_1|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.hora_inicio_1|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.hora_final_1|as_crispy_field }}
                    </div>
                </div>
                <div class="row justify-content-end align-center d-none" id="bloque_2">
                    <div class="d-flex align-items-center my-4">
                        <div class="w-100 d-flex align-items-center" style="position: relative;">
                            <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                            <p class="position-absolute start-50 translate-middle-x mb-0 px-3 bg-white text-primary" style="z-index:1;">Bloque 2</p>
                            <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                        </div>
                    </div>
                    <div class="col-md-3">
                        {{ form.horario_inicio_2|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.horario_final_2|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.hora_inicio_2|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.hora_final_2|as_crispy_field }}
                    </div>
                </div>
                <div class="row justify-content-end align-center d-none" id="bloque_3">
                    <div class="d-flex align-items-center my-4">
                        <div class="w-100 d-flex align-items-center" style="position: relative;">
                            <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                            <p class="position-absolute start-50 translate-middle-x mb-0 px-3 bg-white text-primary" style="z-index:1;">Bloque 3</p>
                            <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                        </div>
                    </div>
                    <div class="col-md-3">
                        {{ form.horario_inicio_3|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.horario_final_3|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.hora_inicio_3|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ form.hora_final_3|as_crispy_field }}
                    </div>
                </div>
                
                <!-- Botón para agregar Bloque 3 (solo visible para HR/HX) -->
                <div class="row d-none" id="boton_bloque_3">
                    <div class="col-md-12 text-center">
                        <button type="button" class="btn btn-outline-primary" id="agregar_bloque_3">
                            <i class="fas fa-plus me-2"></i>Agregar Bloque 3 (Opcional)
                        </button>
                    </div>
                </div>

    
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Funciones y responsabilides del cargo</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-12">
                    {{ form.funciones_responsabilidades_1|as_crispy_field }}
                </div>
                <div class="col-md-12">
                    {{ form.funciones_responsabilidades_2|as_crispy_field }}
                </div>
                <div class="col-md-12">
                    {{ form.funciones_responsabilidades_3|as_crispy_field }}
                </div>
                <div class="col-md-12">
                    <div class="form-group d-flex gap-3">
                        <button class="btn btn-primary py-3 px-5 fw-semibold text-white"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data2\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Siguiente</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pane-data2" role="tabpanel" aria-labelledby="tab-data2" tabindex="0">
            <h4 class="fs-18 fw-semibold">Requisitos técnicos (Hard Skills)</h4>
            <p class="text-gray-light mb-4">Lo que el cargo necesita para operar eficientemente</p>
            <div class="row mb-4 p-3 border rounded bg-primary bg-opacity-10">
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Experiencia Laborales</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-4">
                    {{ form.tiempo_experiencia_1|as_crispy_field }}
                </div> 
                <div class="col-md-8">
                    {{ form.experiencia_especifica_en_1|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.tiempo_experiencia_2|as_crispy_field }}
                </div> 
                <div class="col-md-8">
                    {{ form.experiencia_especifica_en_2|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.tiempo_experiencia_3|as_crispy_field }}
                </div> 
                <div class="col-md-8">
                    {{ form.experiencia_especifica_en_3|as_crispy_field }}
                </div> 
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Idiomas</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-4">
                    {{ form.idioma_1|as_crispy_field }}
                </div> 
                <div class="col-md-8">
                    {{ form.nivel_idioma_1|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.idioma_2|as_crispy_field }}
                </div> 
                <div class="col-md-8">
                    {{ form.nivel_idioma_2|as_crispy_field }}
                </div> 
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Estudios o profesión</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-6 mb-3">
                    {{ form.tipo_profesion|as_crispy_field }}
                </div>
                
                <!-- Campos condicionales -->
                <div id="campo_especifica" class="col-md-6" style="display:none;">
                    {{ form.profesion_estudio|as_crispy_field }}
                </div>
                
                <div id="campo_grupo" class="col-md-6" style="display:none;">
                    {{ form.grupo_profesion|as_crispy_field }}
                </div>
                
                <div id="campo_listado" class="col-md-6" style="display:none;">
                    {{ form.profesion_estudio_listado|as_crispy_field }}
                </div>
                
                <div class="col-md-4">
                    {{ form.nivel_estudio|as_crispy_field }}
                </div>
                
                <div class="col-md-2">
                    {{ form.estado_estudio|as_crispy_field }}
                </div> 
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Estudios complementarios</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-8">
                    {{ form.estudios_complementarios_1|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.estudios_complementarios_certificado_1|as_crispy_field }}
                </div> 
                <div class="col-md-8">
                    {{ form.estudios_complementarios_2|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.estudios_complementarios_certificado_2|as_crispy_field }}
                </div> 
                <div class="col-md-8">
                    {{ form.estudios_complementarios_3|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.estudios_complementarios_certificado_3|as_crispy_field }}
                </div> 
                <div class="col-md-12">
                    <div class="form-group d-flex gap-3">
                        <button class="btn btn-primary bg-primary bg-opacity-10 text-primary py-3 px-5 fw-semibold border-0"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data1\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Volver</button>
                        <button class="btn btn-primary py-3 px-5 fw-semibold text-white"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data3\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Siguiente</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pane-data3" role="tabpanel" aria-labelledby="tab-data3" tabindex="0">
            <h4 class="fs-18 fw-semibold">Competencias Clave (Soft Skills)</h4>
            <p class="text-gray-light mb-4">Selecciona hasta 5 habilidades clave para el éxito de este rol</p>
            
            <div class="row mb-4 p-3 border rounded bg-primary bg-opacity-10">
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Habilidades Blandas</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="alert alert-info" role="alert">
                    <h4 class="alert-heading">
                        <span class="material-symbols-outlined text-info me-2">psychology</span>
                        Selecciona tus habilidades blandas
                    </h4>
                    <p>
                        Esta parte te permite identificar las habilidades blandas que realmente marcan la diferencia en el desempeño de un cargo.
                        Aquí podrás seleccionar cuáles son esenciales para el rol que estás definiendo, asegurando que el talento no solo cumpla con los requisitos técnicos, sino que <b>también encaje con la forma en que tu empresa necesita que se hagan las cosas.</b>
                        <hr>
                        Selecciona máximo 2 competencias por cada categoría (Relacionales, Personales, Cognitivas, Liderazgo, Digitales). Esto asegura un perfil balanceado y enfocado.
                    </p>
                </div>
                <div class="col-md-2">
                    {{ form.skill_relacionales|as_crispy_field }}
                </div> 
                <div class="col-md-2">
                    {{ form.skill_personales|as_crispy_field }}
                </div> 
                <div class="col-md-3">
                    {{ form.skill_cognitivas|as_crispy_field }}
                </div> 
                <div class="col-md-3">
                    {{ form.skill_digitales|as_crispy_field }}
                </div> 
                <div class="col-md-2">
                    {{ form.skill_liderazgo|as_crispy_field }}
                </div> 
                <div class="col-md-12">
                    <div class="form-group d-flex gap-3">
                        <button class="btn btn-primary bg-primary bg-opacity-10 text-primary py-3 px-5 fw-semibold border-0"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data2\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Volver</button>
                        <button class="btn btn-primary py-3 px-5 fw-semibold text-white"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data4\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Siguiente</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pane-data4" role="tabpanel" aria-labelledby="tab-data4" tabindex="0">
            <h4 class="fs-18 fw-semibold">Fit cultural y de entorno</h4>
            <div class="row mb-4 p-3 border rounded bg-primary bg-opacity-10">
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Fit cultural</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="alert alert-info" role="alert">
                    <h4 class="alert-heading">
                        <span class="material-symbols-outlined text-info me-2">psychology</span>
                        Selecciona tus habilidades blandas
                    </h4>
                    <p>
                        El módulo de <b>Fit Cultural y de Entorno</b> permite identificar el tipo de cultura y estilo de trabajo donde un candidato tendrá mayor éxito.
                        Aquí podrás definir cómo se trabaja en tu empresa: estilo predominante, liderazgo presente, ritmo de trabajo, comunicación organizacional y forma de tomar decisiones. Esto asegura que el talento seleccionado no solo cumpla con lo técnico, sino que también encaje con la manera en que tu organización funciona día a día.
                        <hr>
                        Selecciona una opción por cada categoría (Estilo de trabajo, Liderazgo, Ritmo, Comunicación y Decisiones). Esto permite reflejar con precisión el entorno real de tu empresa.
                    </p>
                </div>
                <div class="col-md-4">
                    {{ form.grupo_fit_1|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.grupo_fit_2|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.grupo_fit_3|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.grupo_fit_4|as_crispy_field }}
                </div> 
                <div class="col-md-4">
                    {{ form.grupo_fit_5|as_crispy_field }}
                </div> 
                <div class="col-md-12">
                    <div class="form-group d-flex gap-3">
                        <button class="btn btn-primary bg-primary bg-opacity-10 text-primary py-3 px-5 fw-semibold border-0"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data3\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Volver</button>
                        <button class="btn btn-primary py-3 px-5 fw-semibold text-white"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data5\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Siguiente</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pane-data5" role="tabpanel" aria-labelledby="tab-data5" tabindex="0">
            <h4 class="fs-18 fw-semibold">Motivadores candidato ideal</h4>
            <div class="row mb-4 p-3 border rounded bg-primary bg-opacity-10">
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Motivadores</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="alert alert-info" role="alert">
                    <h4 class="alert-heading">
                        <span class="material-symbols-outlined text-info me-2">psychology</span>
                        Selecciona tus motivadores
                    </h4>
                    <p>
                        El módulo de <b>Motivadores</b> permite identificar qué aspectos son más importantes para atraer y retener el talento en el cargo que estás definiendo.
Aquí podrás señalar qué factores predominan en tu empresa o en el rol: estabilidad, crecimiento, propósito, impacto o remuneración. Esto asegura que el candidato que elijas no solo cumpla con el perfil técnico, sino que también se sienta motivado y alineado con lo que tu organización ofrece.
                        <hr>
                        Selecciona máximo <b>2 motivadores principales</b> que reflejen la propuesta de valor de tu empresa o del cargo. Esto ayudará a generar una conexión auténtica con los candidatos.
                    </p>
                </div>
                <div class="col-md-12">
                    <div class="motivadores-field-wrapper">
                        {{ form.motivadores_candidato|as_crispy_field }}
                    </div>
                </div> 
                <div class="col-md-12">
                    <div class="form-group d-flex gap-3">
                        <button class="btn btn-primary bg-primary bg-opacity-10 text-primary py-3 px-5 fw-semibold border-0"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data4\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Volver</button>
                        <button class="btn btn-primary py-3 px-5 fw-semibold text-white"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data6\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Siguiente</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pane-data6" role="tabpanel" aria-labelledby="teb-data6" tabindex="0">
            <h4 class="fs-18 fw-semibold">Insights y comentarios finales</h4>
            <p class="text-gray-light mb-4">Comentarios finales sobre los retos o prioridades del cargo:</p>
            <div class="row mb-4 p-3 border rounded bg-primary bg-opacity-10">
                <div class="d-flex align-items-center my-4">
                    <h6 class="mb-0 pe-3 text-primary fw-bold">Comentarios</h6>
                    <hr class="flex-grow-1 m-0 border-top border-1 border-secondary opacity-20">
                </div>
                <div class="col-md-12">
                    {{ form.comentarios|as_crispy_field }}
                </div> 
                <div class="col-md-12">
                    {{ form.descripcion_vacante|as_crispy_field }}
                </div> 
                <div class="col-md-12">
                    <div class="form-group d-flex gap-3">
                        <button class="btn btn-primary bg-primary bg-opacity-10 text-primary py-3 px-5 fw-semibold border-0"
                        onclick="
                                event.preventDefault();
                                bootstrap.Tab.getOrCreateInstance(document.querySelector('[data-bs-target=\'#pane-data4\']')).show();
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                                ">Volver</button>
                        <button id="form_vacante_todos" type="submit" class="btn btn-primary py-3 px-5 fw-semibold text-white" form="form_vacante_todos">Guardar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

<style>
/* Estilos para los badges de error - MÁS VISIBLE */
.error-badge {
    width: 20px !important;
    height: 20px !important;
    background-color: #dc3545 !important;
    background: #dc3545 !important;
    border: 4px solid #ffffff !important;
    border-radius: 50% !important;
    z-index: 9999 !important;
    box-shadow: 0 0 20px rgba(220, 53, 69, 1), 0 0 30px rgba(220, 53, 69, 0.8) !important;
    opacity: 1 !important;
    animation: errorBlink 0.5s infinite !important;
    position: absolute !important;
    top: -5px !important;
    right: -5px !important;
}

/* Asegurar que el badge sea visible */
.position-relative {
    position: relative !important;
}

/* Animación de parpadeo MUY llamativa */
@keyframes errorBlink {
    0% {
        background: #dc3545 !important;
        transform: scale(1);
        box-shadow: 0 0 20px rgba(220, 53, 69, 1), 0 0 30px rgba(220, 53, 69, 0.8);
    }
    25% {
        background: #dc3545 !important;
        transform: scale(1.6);
        box-shadow: 0 0 30px rgba(220, 53, 69, 1), 0 0 50px rgba(220, 53, 69, 0.9);
    }
    50% {
        background: #dc3545 !important;
        transform: scale(1.3);
        box-shadow: 0 0 40px rgba(220, 53, 69, 1), 0 0 60px rgba(220, 53, 69, 1);
    }
    75% {
        background: #dc3545 !important;
        transform: scale(1.6);
        box-shadow: 0 0 30px rgba(220, 53, 69, 1), 0 0 50px rgba(220, 53, 69, 0.9);
    }
    100% {
        background: #dc3545 !important;
        transform: scale(1);
        box-shadow: 0 0 20px rgba(220, 53, 69, 1), 0 0 30px rgba(220, 53, 69, 0.8);
    }
}

/* Asegurar que el badge tenga prioridad visual */
.error-badge:hover {
    animation-play-state: paused;
    background: #dc3545 !important; /* Rojo intenso en hover */
    transform: scale(1.5);
    box-shadow: 0 0 25px rgba(220, 53, 69, 1), 0 0 45px rgba(220, 53, 69, 0.9);
}
</style>